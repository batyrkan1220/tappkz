Настройка ограничений для API-ключа
API-ключ можно привязать к доменам или IP-адресам, чтобы ограничить запросы из других источников. Эта настройка не позволит использовать ваш ключ в чужих сервисах.

Примечание

Ограничение касается только тарифицируемых запросов. На другом сайте карта появится, но все тарифицируемые операции не будут работать.

Какие ограничения можно использовать
IP-адрес — адрес устройства, с которого отправлен запрос. Для запросов, отправленных с сайтов, это адрес устройства пользователя (не адрес сервера, на котором размещается сайт). Для запросов, отправленных с сервера или локального устройства, IP-адрес совпадает с внешним адресом сервера или устройства.

Домен — переданный в заголовке Referer запроса домен. Для запросов, отправленных с сайтов, заголовок обычно указывается автоматически и совпадает с адресом страницы. Некоторые сайты используют контейнеры или не передают Referer. Если запрос отправлен с сервера или с локального устройства (например, с помощью curl), заголовок необходимо указать самостоятельно.

Как добавить настройки для API-ключа
Чтобы прописать разрешенные домены и IP-адреса для вашего API-ключа:

Зайдите в Кабинет разработчика.

Выберите нужный вам ключ и нажмите Изменить.

Укажите список IP-адресов, с которых можно делать запросы, по одному адресу в строке. Поддерживаются как IPv4, так и IPv6 адреса, а также подсети. Например, можно указать адреса следующим образом:

192.0.2.0
192.0.2.0/24
2001:db8::/32

Примечание

При загрузке карты используется IP-адрес устройства пользователя. При работе с JSAPI мы рекомендуем использовать ограничение по домену.

Укажите список доменов, с которых можно делать запросы. Информация о доменах передается в заголовке Referer. Домены указываются по одному в строке, без указания порта, URL-схемы и параметров. В качестве значения в заголовке Referer указывается URL (например, https://www.yandex.ru). Все поддомены автоматически добавляются в список разрешенных. Например, можно указать домены следующим образом:

yandex.ru
yandex.com
example.com

Введенные ограничения начинают работать через 15 минут после заполнения формы.

Как проверяются ограничения для API-ключа
Проверка ключа производится следующим образом:

Проверка на IP-адрес не строгая
Если указан IP-адрес, он должен совпадать с IP-адресом источника запроса.
Если IP-адрес не указан, пользователь может пользоваться картой с любого IP-адреса.
Проверка на Referer строгая
Если указан домен, он должен совпадать с заголовком Referer.
Как отобразить карту в контейнере
При отображении карты в контейнерах, например, WebView или iframe, устройство пользователя может передать некорректный HTTP-referer. Ниже приведены рекомендации по работе с популярными контейнерами.